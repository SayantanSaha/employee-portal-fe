<div [class.container]="!fromfunction || fromfunction ==null || fromfunction == 'edit' || fromfunction == 'summary'"
  [class.container-fluid]="fromfunction && fromfunction == 'totalpass'">


  <ng-container *ngIf="fromfunction && fromfunction == 'summary' && counts && counts.length > 0">
    <div class="card shadow">
      <div class="card-header">
        <div class="card-title">
          <b>Employee Counts</b>
        </div>
      </div>

      <div class="card-body">
        <div style="padding: 1%">
          <div class="row mb-12" style="text-align: center;">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>&nbsp;</th>
                  <th>&nbsp;</th>
                  <th colspan="4">Permanent</th>
                  <th colspan="3">Temporary</th>
                  <th>Duty Pass</th>
                  <th>&nbsp;</th>
                </tr>
                <tr>
                  <th>Sl No.</th>
                  <th style="text-align: left;">Organisation</th>
                  <th class="table-danger">Red</th>
                  <th class="table-danger">Purple</th>
                  <th class="table-danger">Green</th>
                  <th class="table-danger">Total</th>
                  <th class="table-danger">Yellow</th>
                  <th class="table-danger">Yellow Paper</th>
                  <th class="table-danger">Total</th>
                  <th class="table-primary">Blue</th>
                  <th class="table-danger">Total employees</th>
                </tr>
              </thead>

              <tbody>
                <tr *ngFor="let count of counts; let i = index">
                  <td>{{ i + 1 }}</td>
                  <td style="text-align: left;">{{ count?.org_desc }}</td>

                  <!-- Permanent Data -->
                  <td class="table-success">{{ count?.r }}</td>
                  <td class="table-success">{{ count?.p }}</td>
                  <td class="table-success">{{ count?.g }}</td>
                  <td class="table-danger">{{ count?.perm }}</td>

                  <!-- Temporary Data -->
                  <td class="table-warning">{{ count?.y }}</td>
                  <td class="table-warning">{{ count?.yp }}</td>
                  <td class="table-danger">{{ count?.temp }}</td>

                  <td class="table-primary">{{ count?.b }}</td>
                  <td class="table-danger">{{ count?.total_count }}</td>
                </tr>

                <!-- Total Row -->
                <tr class="fw-bold">
                  <td>&nbsp;</td>
                  <td><strong>Total</strong></td>

                  <!-- Permanent Totals -->
                  <td class="table-success">{{ totalCounts.r }}</td>
                  <td class="table-success">{{ totalCounts.p }}</td>
                  <td class="table-success">{{ totalCounts.g }}</td>
                  <td class="table-danger">{{ totalCounts.perm }}</td>

                  <!-- Temporary Totals -->
                  <td class="table-warning">{{ totalCounts.y }}</td>
                  <td class="table-warning">{{ totalCounts.yp }}</td>
                  <td class="table-danger">{{ totalCounts.temp }}</td>

                  <td class="table-primary">{{ totalCounts.b }}</td>
                  <td class="table-danger">{{ totalCounts.total_count }}</td>
                </tr>
              </tbody>
            </table>

          </div>
        </div>
      </div>
    </div>
  </ng-container>

  <div class="card shadow" *ngIf="rbprintData && rbprintData.length>0 ">
    <div class="card-header">
      <div class="card-title">
        <b>Total List ({{rbprintData.length}})</b>
      </div>
    </div>
    <div class="card-body">
      <div style="padding: 1%">
        <div class="row mb-12">


          <!-- <table mat-table [dataSource]="dataSource" matSort class="table table-striped">
            <thead>
              <tr>
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Sl No.</th>
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Officer Name</th>

                <ng-container *ngIf="fromfunction && fromfunction == 'totalpass'">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Dob</th>
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Dor</th>
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Mobile</th>
                </ng-container>

                <th mat-header-cell *matHeaderCellDef mat-sort-header>RB Card</th>
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Issue Date</th>
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Exp Date</th>

                <ng-container *ngIf="fromfunction">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Police Verification No</th>
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Card Type</th>
                </ng-container>

                <ng-container *ngIf="fromfunction && fromfunction == 'totalpass'">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Organization</th>
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Designation</th>
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Pay Level</th>
                </ng-container>

                <ng-container *ngIf="!fromfunction || fromfunction == 'totalpass'">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Rfid</th>
                </ng-container>

                <ng-container *ngIf="!fromfunction || fromfunction == null || fromfunction == 'edit'">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Action</th>
                </ng-container>
              </tr>
            </thead>

            <tbody>
              <tr *ngFor="let ebaprint of dataSource.data; let i = index">
                <td mat-cell>{{ i + 1 }}</td>
                <td mat-cell>{{ ebaprint?.emp_name }}</td>


                <ng-container *ngIf="fromfunction && fromfunction == 'totalpass'">
                  <td mat-cell>{{ ebaprint?.dob | date: 'dd-MM-yyyy' }}</td>
                  <td mat-cell>{{ ebaprint?.dor | date: 'dd-MM-yyyy' }}</td>
                  <td mat-cell>{{ ebaprint?.mobile }}</td>
                </ng-container>

                <td mat-cell>{{ ebaprint.card_no }}</td>
                <td mat-cell>{{ ebaprint!.valid_from | date: 'dd-MM-yyyy' }}</td>
                <td mat-cell>{{ ebaprint!.valid_to | date: 'dd-MM-yyyy' }}</td>

                <ng-container *ngIf="fromfunction">
                  <td mat-cell>{{ ebaprint!.police_verification_no }}</td>
                  <td mat-cell>
                    <ng-container *ngIf="ebaprint!.active === 1">Active</ng-container>
                    <ng-container *ngIf="ebaprint!.active === 0">Cancelled/expired</ng-container>
                  </td>
                  <td mat-cell>
                    <ng-container [ngSwitch]="ebaprint!.card_type_id">
                      <div *ngSwitchCase="1">Green</div>
                      <div *ngSwitchCase="2">Purple</div>
                      <div *ngSwitchCase="3">Red</div>
                      <div *ngSwitchCase="4">Yellow Card</div>
                      <div *ngSwitchCase="5">Duty Pass</div>
                      <div *ngSwitchCase="6">Yellow Paper</div>
                      <div *ngSwitchDefault>Unknown</div>
                    </ng-container>
                  </td>
                </ng-container>


                <ng-container *ngIf="fromfunction && fromfunction == 'totalpass'">
                  <td mat-cell>{{ ebaprint.org_desc }}</td>
                  <td mat-cell>{{ ebaprint.desg_desc }}</td>
                  <td mat-cell>{{ ebaprint.pay_desc }}</td>
                </ng-container>

                <ng-container *ngIf="fromfunction && fromfunction == 'totalpass'">
                  <td mat-cell>
                    <ng-container *ngIf="ebaprint.rfid && ebaprint.rfid != null">Active</ng-container>
                    <ng-container *ngIf="!ebaprint.rfid || ebaprint.rfid == null">In-Active</ng-container>
                  </td>
                </ng-container>

                <ng-container *ngIf="fromfunction && fromfunction == 'edit'">
                  <td mat-cell>
                    <button class="btn btn-warning enlarge-on-hover" (click)="openeditcardPopup(i)">edit</button>
                  </td>
                </ng-container>

                <ng-container *ngIf="!fromfunction || fromfunction == null">
                  <td mat-cell *ngIf="ebaprint.rfid == null">
                    <button class="btn btn-primary enlarge-on-hover" (click)="openebacardPopup(i)">Update</button>
                  </td>
                  <td mat-cell *ngIf="ebaprint.rfid !== null">{{ ebaprint.rfid }}</td>
                </ng-container>
              </tr>
            </tbody>
          </table>

          <mat-paginator [length]="rbprintData.length" [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator> -->

            <table id="datatableexample" >
              <thead>
                <tr>
                  <th>Sl No.</th>
                  <th>Officer Name</th>

                  <ng-container *ngIf="fromfunction && fromfunction == 'totalpass'">
                    <th>Dob</th>
                    <th>Dor</th>
                    <th>Mobile</th>
                  </ng-container>

                  <th>RB Card</th>
                  <th>Issue Date</th>
                  <th>Exp Date</th>

                  <ng-container *ngIf="fromfunction">
                    <th>Police Verification No</th>
                    <th>Status</th>
                    <th>Card Type</th>
                  </ng-container>

                  <ng-container *ngIf="fromfunction && fromfunction == 'totalpass'">
                    <th>Organization</th>
                    <th>Designation</th>
                    <th>Pay Level</th>
                  </ng-container>

                  <ng-container *ngIf="!fromfunction || fromfunction == 'totalpass'">
                    <th>Rfid</th>
                  </ng-container>

                  <ng-container *ngIf="!fromfunction || fromfunction == null || fromfunction == 'edit'">
                    <th>Action</th>
                  </ng-container>
                </tr>
              </thead>

              <tbody>
                <tr *ngFor="let ebaprint of rbprintData; let i = index">
                  <td>{{ i + 1 }}</td>
                  <td>{{ ebaprint?.emp_name }}</td>


                  <ng-container *ngIf="fromfunction && fromfunction == 'totalpass'">
                    <td>{{ ebaprint?.dob | date: 'dd-MM-yyyy' }}</td>
                    <td>{{ ebaprint?.dor | date: 'dd-MM-yyyy' }}</td>
                    <td>{{ ebaprint?.mobile }}</td>
                  </ng-container>

                  <td>{{ ebaprint.card_no }}</td>
                  <td>{{ ebaprint!.valid_from | date: 'dd-MM-yyyy' }}</td>
                  <td>{{ ebaprint!.valid_to | date: 'dd-MM-yyyy' }}</td>

                  <ng-container *ngIf="fromfunction">
                    <td>{{ ebaprint!.police_verification_no }}</td>
                    <td>
                      <ng-container *ngIf="ebaprint!.active === 1">Active</ng-container>
                      <ng-container *ngIf="ebaprint!.active === 0">Cancelled/expired</ng-container>
                    </td>
                    <td>
                      <ng-container [ngSwitch]="ebaprint!.card_type_id">
                        <div *ngSwitchCase="1">Green</div>
                        <div *ngSwitchCase="2">Purple</div>
                        <div *ngSwitchCase="3">Red</div>
                        <div *ngSwitchCase="4">Yellow Card</div>
                        <div *ngSwitchCase="5">Duty Pass</div>
                        <div *ngSwitchCase="6">Yellow Paper</div>
                        <div *ngSwitchDefault>Unknown</div>
                      </ng-container>
                    </td>
                  </ng-container>


                  <ng-container *ngIf="fromfunction && fromfunction == 'totalpass'">
                    <td>{{ ebaprint.org_desc }}</td>
                    <td>{{ ebaprint.desg_desc }}</td>
                    <td>{{ ebaprint.pay_desc }}</td>
                  </ng-container>

                  <ng-container *ngIf="fromfunction && fromfunction == 'totalpass'">
                    <td>
                      <ng-container *ngIf="ebaprint.rfid && ebaprint.rfid != null">Active</ng-container>
                      <ng-container *ngIf="!ebaprint.rfid || ebaprint.rfid == null">In-Active</ng-container>
                    </td>
                  </ng-container>

                  <ng-container *ngIf="fromfunction && fromfunction == 'edit'">
                    <td>
                      <button class="btn btn-warning enlarge-on-hover" (click)="openeditcardPopup(i)">edit</button>
                    </td>
                  </ng-container>

                  <ng-container *ngIf="!fromfunction || fromfunction == null">
                    <td *ngIf="ebaprint.rfid == null">
                      <button class="btn btn-primary enlarge-on-hover" (click)="openebacardPopup(i)">Update</button>
                    </td>
                    <td *ngIf="ebaprint.rfid !== null">{{ ebaprint.rfid }}</td>
                    <td>
                      <div class="col"
                        *ngIf="ebaprint.rfid ==null && (ebaprint.printed==false ||  ebaprint.printed==null)">
                        <button class="btn btn-success enlarge-on-hover" (click)="hoverClick($event)"
                          (click)="printpage(i)">
                          Print
                        </button>
                      </div>
                      <div class="col" *ngIf="ebaprint.rfid ==null && ebaprint.printed==true ">
                        <button class="btn btn-success enlarge-on-hover" (click)="hoverClick($event)"
                          (click)="printpage(i)">
                          Re-Print
                        </button>
                      </div>
                    </td>
                  </ng-container>

                </tr>
              </tbody>
            </table>


        </div>
      </div>
    </div>
  </div>
</div>

<td *ngIf="printData && printData!= null">
  <div class="modal modal-above-header" tabindex="-1" data-bs-backdrop="false" [ngStyle]="{'display': ebacard }"
    style="backdrop-filter: blur(3px);background-color: rgba(128, 128, 128, 0.7); overflow-y: auto; ">
    <div class="modal-dialog modal-dialog-centered modal-m">
      <div class="modal-content" style="width:100mm">
        <div class="modal-header">
          <h5 class="modal-title">
            <b>{{printData.card_no}}</b>
          </h5>
        </div>
        <div class="modal-body">
          <label class="form-label">Rfid no</label>
          <input type="text" class="form-control" placeholder="xxxxx" aria-label="Name" [(ngModel)]="Rfid">
        </div>
        <div class="modal-footer">

          <button type="button" class="btn btn-outline-secondary enlarge-on-hover" (click)="hoverClick($event)"
            (click)="closeebacardPopup()">
            Close
          </button>

          <button type="button" class="btn btn-outline-info enlarge-on-hover" (click)="hoverClick($event)"
            (click)="rfid(printData.card_no)">
            Update Rfid
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal modal-above-header" tabindex="-1" data-bs-backdrop="false" [ngStyle]="{'display': editcard }"
    style="backdrop-filter: blur(3px);background-color: rgba(128, 128, 128, 0.7); overflow-y: auto; ">
    <div class="modal-dialog modal-dialog-centered modal-xl">
      <div class="modal-content">
        <div class="modal-body">
          <table class="table table-stripped">
            <thead>
              <tr>
                <th>Name</th>
                <th>Card NO</th>
                <!-- <th>Color<span class="text-danger">*</span></th> -->
                <th>Issue date</th>
                <th>Exp date</th>
                <th>Police verification No</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <!-- <input *ngIf="employee!.id_cards && editable" type="text" class="form-control" placeholder="RB-XXX-X-X-XXXX"
                      aria-label="card_no" [(ngModel)]="employee!.id_cards![i]!.card_no"
                      (ngModelChange)="onInputChangeMap('id_card', i)"> -->
                  <span>{{printData.emp_name}}</span>
                </td>
                <td>
                  <!-- <input *ngIf="employee!.id_cards && editable" type="text" class="form-control" placeholder="RB-XXX-X-X-XXXX"
                      aria-label="card_no" [(ngModel)]="employee!.id_cards![i]!.card_no"
                      (ngModelChange)="onInputChangeMap('id_card', i)"> -->
                  <span>{{printData.card_no}}</span>
                </td>
                <!-- <td>
                        <select  *ngIf="employee!.id_cards && editable" class="form-control" [(ngModel)]="employee!.id_cards![i]!.card_type_id"  (ngModelChange)="onInputChangeMap('id_card', i)">
                          <option value="null">--Select Pass Color--</option>
                          <option *ngFor="let passColor_issued of passColors" [ngValue]="passColor_issued.id">
                            {{ passColor_issued.color }}
                          </option>
                        </select>
                      </td> -->
                <td>
                  <input type="date" class="form-control" placeholder="exp_date" aria-label="exp_date"
                    [(ngModel)]="printData.valid_from">
                </td>
                <td>
                  <input type="date" class="form-control" placeholder="exp_date" aria-label="exp_date"
                    [(ngModel)]="printData.valid_to">
                </td>
                <td>
                  <input type="text" class="form-control" placeholder="Pol-verifcation-no"
                    aria-label="Pol-verifcation-no" [(ngModel)]="printData.police_verification_no">
                </td>
                <td>
                  <ng-container>
                    <select class="form-control" [(ngModel)]="printData.active">
                      <option [ngValue]="0">In-Active</option>
                      <option [ngValue]="1">Active</option>
                    </select>
                  </ng-container>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="modal-footer">

            <button type="button" class="btn btn-outline-secondary enlarge-on-hover" (click)="hoverClick($event)"
              (click)="closeeditcardPopup()">
              Close
            </button>


            <button type="button" class="btn btn-outline-success enlarge-on-hover"
              (click)="hoverClick($event);saveIdcards(printData)">Update</button>

          </div>
        </div>
      </div>
    </div>
  </div>



</td>

<!-- <mat-progress-spinner *ngIf="isLoading" mode="indeterminate" class="loading-spinner"></mat-progress-spinner> -->
